# @desc: Wrapper system (+wrap, +unwrap)

# @test: "a"
# @expect: wrapper command

# @test: "b"
# @expect: wrapper cmd

# @test: "c"
# @expect: custom cmd

# @test: "d"
# @expect: cmd

# @test: "p e"
# @expect: wrapper cmd

# @test: "f"
# @expect: cmd

# @test: "g h"
# @expect: alt cmd1

# @test: "g i"
# @expect: alt cmd2

# Wrapper test fixture - uses :wrap-cmd once
:wrap-cmd "wrapper"

# Test 1: Auto-wrap with global wrapper
a "Auto wrap" +write %{{command}}

# Test 2: Explicit +wrap (uses global wrapper)
b "Explicit wrap" +wrap +write %{{cmd}}

# Test 3: Custom +wrap overrides global
c "Custom wrap" +wrap "custom" +write %{{cmd}}

# Test 4: +unwrap overrides global wrapper
d "Unwrapped" +unwrap +write %{{cmd}}

# Test 5: Inheritance - unwrap parent, child should inherit
p "Prefix unwrapped" +unwrap
{
    e "Child inherits unwrap" +write %{{cmd}}
}

# Test 6: Another unwrap test
f "No wrapper" +unwrap +write %{{cmd}}

# Test 7: Inheritance - custom wrap parent, children should inherit
g "Multi" +wrap "alt"
{
    h "Child with alt" +write %{{cmd1}}
    i "Another child" +write %{{cmd2}}
}
